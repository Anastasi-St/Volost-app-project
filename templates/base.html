<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{{ title }}</title>
        <style>

        </style>
        <!-- Latest compiled and minified CSS -->
        <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">-->
        <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}" type="text/css">
        <!-- jQuery library -->
        <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js" type="text/javascript"></script>-->
        <script src="{{ url_for('static', filename='js/jquery.js') }}"></script>
        <!-- JQuery DataTables -->
        <!--<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js" type="text/javascript"></script>-->
        <script src="{{ url_for('static', filename='js/datatables.js') }}"></script>
        <!-- DataTables CSS -->
        <!--<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">-->
        <link rel="stylesheet" href="{{ url_for('static', filename='css/datatables.css') }}">
        <!-- Popper JS -->
        <!--<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" type="text/javascript"></script>-->
        <script src="{{ url_for('static', filename='js/popper.js') }}"></script>
        <!-- Latest compiled JavaScript -->
        <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" type="text/javascript"></script>-->
        <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.bundle.min.js') }}"></script>

        <!-- JQuery Tablesorter -->
        <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.3/js/jquery.tablesorter.min.js"></script>-->

        <!-- Plug-in to sort dates -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>
        <script src="https://cdn.datatables.net/plug-ins/1.11.5/sorting/datetime-moment.js"></script>
        <script src="https://cdn.datatables.net/plug-ins/1.11.5/sorting/date-de.js"></script>
        <!-- Plug-in for dropdown multiselect -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>

        <script>
            $(document).ready(function() {
                $.fn.dataTable.moment( 'DD.MM.YYYY HH:mm' );
                $.fn.dataTable.moment( 'DD.MM.YYYY' );

                var table = $('#docsTable').DataTable({
                    "language": {
                        "url": "https://cdn.datatables.net/plug-ins/1.11.5/i18n/ru.json"
                    },
                    "dom": "lrtip",
                    "lengthMenu":  [ [50, 100, 500, -1], [50, 100, 500, "Все"] ],
                    "aaSorting": [],
                    "bStateSave": true,
                    "fnStateSave": function (oSettings, oData) {
                        localStorage.setItem( 'DataTables', JSON.stringify(oData) );
                    },
                    "fnStateLoad": function (oSettings) {
                        return JSON.parse( localStorage.getItem('DataTables') );
                    },

                    "columnDefs": [
                        { type: 'de_datetime', targets: 1 },
                        { type: 'de_date', targets: 7 },
                        { type: 'de_date', targets: 8 },
                        { type: 'de_date', targets: 20 },
                        { type: 'de_date', targets: 21 },
                        { type: 'de_date', targets: 23 }
                    ]
                });

                $('.dataTables_length').addClass('bs-select');

                $("#searchButton").click(function() {
                    var value = $("#searchBar").val().toLowerCase();
                    table
                    .column(0)
                    .search(value)
                    .draw();
                });

                $("#searchBar").keypress(function(e) {
                    if(e.which === 13) {
                        e.preventDefault();
                        table.column(0).search($(this).val()).draw();
                    }
                });
            });
        </script>
    </head>
    <body>
        {% set nav_bar = [
            ('index', 'Документы'),
            ('research', 'Исследования'),
            ('about_project', 'О проекте'),
        ]
        -%}
        {% set active_page = active_page|default('index') -%}
    <div class="container-fluid px-4 py-3">
        <div class="clearfix pb-3">
            <div class="float-left">
                <ul class="nav nav-tabs">
                    {% for href, caption in nav_bar %}
                    <li class="nav-item">
                        <a class="nav-link{% if href == active_page %} active"{% endif %}" href="{{ url_for(href) }}">{{ caption|e }}</a>
                    </li>
                    {% endfor %}
                    <!-- <li><a href="{{ url_for('index') }}">Документы</a></li> (accessible to anyone)
                    <li><a href="{{ url_for('research') }}">Исследования</a></li> (login_required: member1/2@example.com / Password1)
                    <li><a href="{{ url_for('about_project') }}">О проекте</a></li> (role_required: admin@example.com / Password1')-->
                </ul>
            </div>

            <div class="d-flex float-right">
                <div class="order-1">
                    {% if current_user.is_authenticated %}
                    <p id="user_name" class="py-2 pr-3 mb-0">
                        {% if current_user.is_authenticated %}
                        Вы вошли как <b>{{ current_user.first_name }} {{ current_user.last_name }}</b>
                        {% endif %}
                    </p>
                        {% set page_action = 'user.logout' %}
                        {% set text = "Выйти" %}
                    {% else %}
                        {% set page_action = 'user.login' %}
                        {% set text = "Войти" %}
                    {% endif %}
                </div>
                <div class="order-2">
                    <a class="btn btn-primary float-right" id="sign_in_out" href="{{ url_for(page_action) }}">{{text}}</a>
                </div>
            </div>
        </div>

        {% block content%}

        {% endblock %}
    </div>
    </body>

    {% block scripts %}
        <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" type="text/css">
    {% endblock %}
</html>