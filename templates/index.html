{% extends "base.html" %}
{% set active_page = 'index' %}
{% block content %}

    <!-- <p><a href="{{ url_for('user.register') }}">{% trans %}Register{% endtrans %}</a></p> -->
    <!--{% if current_user.is_authenticated %}
        <p>Статус:
            {% if user_roles %}
                {{ user_roles|join(', ') }}
            {% else %}
                нет
            {% endif %}
        </p>
    {% endif %}-->
    <!--<form method="GET">
        <p><label for="doc_id">ID: </label>
        <input type="text" id="doc_id" name="doc_id"></p>
        <p><input type="submit" value="Искать"></p>
    </form>-->
    <!--<table border="1" style="border-collapse:collapse">
        <tr>
            <th>id дока</th>
            <th>тема</th>
        </tr>
        {% for doc in docs_themes %}
            <tr>
                <td>{{ doc['id'] }}</td>
                <td>{{ doc['themes']|join(', ') }}</td>
            </tr>
        {% endfor %}
    </table>-->
    {% set short_dates = ["create_date", "decision_date", "appeal_date", "ap_decision_date", "decision_exec_date"] %}

    <div class="row">
        <div class="col-6">
            <div class="input-group mb-2">
                <input type="text" id="searchBar" class="form-control" placeholder="Введите название документа">
                <span class="input-group-btn">
                    <button class="btn btn-secondary ml-2" id="searchButton">Искать</button>
                </span>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col">
            <button id="advancedSearch" class="btn btn-secondary dropdown-toggle mb-2" data-toggle="dropdown">Расширенный поиск&nbsp</button>
            <span id="searchForm"> <!--style="display: none;">-->
                <form action="" method="POST">
                    {{ form.csrf_token() }}
                    {% for field in form if field.name not in diff_fields %}
                        {% if field.name in choices %}
                            <span class="p-1">
                                    {{ field.label(class="pt-2 pb-2 pr-2") }}
                                    {{ field(class="multiple small", multiple="multiple") }}
                            </span>
                        {% elif field.name in checkboxes %}
                            <span class="p-1">
                                {{ field.label(class="pt-2 pb-2 pr-2") }}
                                {{ field(class="align-middle") }}
                            </span>
                        {% else  %}
                            <div class="input-group">
                                {{ field.label(class="pt-2 pb-2 pr-2") }}
                                <span>
                                    {{ field(class="form-control pl-2") }}
                                </span>
                            </div>
                        {% endif %}
                    {% endfor %}

                    <div class="form-group">
                        {{ form.submit(class="btn btn-secondary mt-2") }}
                        <span>
                            <button id="resetForm" class="btn btn-secondary mt-2 ml-2">Очистить</button>
                        </span>
                    </div>

                </form>
            </span>
        </div>
    </div>


    <div class="table table-bordered table-hover table-responsive small">
    <table class="py-1" id="docsTable">
        <thead class="bg-light">
            <tr>
                <th class="align-middle text-center">Название документа</th>
                {% for col in column_dict.values() %}
                <th class="align-middle text-center">{{ col }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
        {% for doc in docs_list %}
            <tr>
                <td class="align-middle"><a href="/{{ doc['id'] }}">{{ doc['doc_name'] }}</a></td>
                {% for value in column_dict.keys() %}
                <td class="align-middle text-center">{% if doc[value] is sameas none or doc[value] is sameas '' %}
                    <b><i>Не указано</i></b>
                    {% elif doc[value] is sameas true %}
                        <b>&check;</b>
                    {% elif doc[value] is sameas false %}
                        &#10060;
                    {% elif value in short_dates %}
                        {{ doc[value].strftime('%d.%m.%Y') }}
                    {% elif value == "reg_date" %}
                        {{ doc[value].strftime('%d.%m.%Y %H:%M') }}
                    {% else %}
                        {{ doc[value] }}
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>

{% endblock %}